import{_ as e,c as a,o as l,a1 as t}from"./chunks/framework.BwTyoF0R.js";const _=JSON.parse('{"title":"file-crawler ( Write Up )","description":"","frontmatter":{},"headers":[],"relativePath":"writeups/file-crawler.md","filePath":"writeups/file-crawler.md"}'),r={name:"writeups/file-crawler.md"},i=t('<h1 id="file-crawler-write-up" tabindex="-1">file-crawler ( Write Up ) <a class="header-anchor" href="#file-crawler-write-up" aria-label="Permalink to &quot;file-crawler ( Write Up )&quot;">​</a></h1><p><a href="https://app.cyber-edu.co/challenges/981dca90-04bf-11ec-920e-fd2fbb634a4c?tenant=cyberedu" target="_blank" rel="noreferrer">file-crawler</a></p><h2 id="🔻-step-1-觀察與測試" tabindex="-1">🔻 Step 1. 觀察與測試 <a class="header-anchor" href="#🔻-step-1-觀察與測試" aria-label="Permalink to &quot;🔻 Step 1. 觀察與測試&quot;">​</a></h2><ol><li>在網頁原始碼中，發現路徑為 <code>/local?image_name=static/path.jpg</code> 的圖片。</li><li>基本的觀察後，可以發現 <code>image_name</code> 後面接著的是一個檔案路徑。</li><li>根據題目的說明 <code>The flag is located in a temporary folder</code>，可以判斷 flag 藏在暫存資料夾中。</li></ol><h2 id="🔻-step-2-修改與嘗試" tabindex="-1">🔻 Step 2. 修改與嘗試 <a class="header-anchor" href="#🔻-step-2-修改與嘗試" aria-label="Permalink to &quot;🔻 Step 2. 修改與嘗試&quot;">​</a></h2><ol><li>已知 Linux 主機的暫存資料夾位於 <code>/tmp/</code>。</li><li>嘗試幾次將路徑修改為 <code>/local?image_name=/tmp/flag.txt</code> 及 <code>/local?image_name=/tmp/flag.php</code> 等。</li><li>最後在路徑為 <code>/local?image_name=/tmp/flag</code> 時，獲得了名為 local 的檔案，取得本題 flag。</li></ol><h2 id="cwe-資訊" tabindex="-1">CWE 資訊 <a class="header-anchor" href="#cwe-資訊" aria-label="Permalink to &quot;CWE 資訊&quot;">​</a></h2><p>CWE-22: Improper Limitation of a Pathname to a Restricted Directory (&#39;Path Traversal&#39;) CWE-36: Absolute Path Traversal CWE-37: Path Traversal: &#39;/absolute/pathname/here&#39;</p><h2 id="漏洞修補建議" tabindex="-1">漏洞修補建議 <a class="header-anchor" href="#漏洞修補建議" aria-label="Permalink to &quot;漏洞修補建議&quot;">​</a></h2><ul><li>使用其他方法讀取檔案</li><li>限制程式所能讀取的內容與範圍</li></ul><h2 id="總結" tabindex="-1">總結 <a class="header-anchor" href="#總結" aria-label="Permalink to &quot;總結&quot;">​</a></h2><p>根據題目的提示以及對 Linux 基礎的了解，反覆的嘗試後即可利用路徑遍歷完成題目，是很典型的漏洞之一。</p>',12),o=[i];function c(d,n,s,h,p,f){return l(),a("div",null,o)}const u=e(r,[["render",c]]);export{_ as __pageData,u as default};
